# 매도 기록 영구 저장 업데이트 v6.16-SELLHISTORY

## 🎯 업데이트 내용

### ⭐ 새로운 기능: 매도 기록 영구 저장
- **문제**: 기존에는 매도 결과가 5초 후 사라짐
- **해결**: 매수 기록처럼 매도 기록이 계속 표시됨
- **저장**: 최근 10건의 매도 기록 유지
- **표시**: 화면에 최근 5건 표시

---

## 📊 매도 기록 표시 예시

```
[ 📜 매도 기록 (3건) ]
  ✅ 14:35:22 | KRW-BTC | +1,250원 (+2.45%) | aggressi
  ❌ 14:30:15 | KRW-ETH | -350원 (-0.87%) | conserva
  ✅ 14:25:08 | KRW-XRP | +800원 (+1.52%) | scalping
```

---

## 🔄 업데이트 전후 비교

### ❌ 이전 (v6.15)
- 매도 결과 5초 후 사라짐
- 과거 매도 기록 확인 불가
- 실시간 매도만 확인 가능

### ✅ 이후 (v6.16-SELLHISTORY)
- 매도 기록 영구 저장 (최대 10건)
- 최근 5건 항상 화면에 표시
- 매수 기록처럼 사라지지 않음
- 시간, 티커, 손익, 전략 모두 표시

---

## 💾 데이터 구조

### 매도 기록 저장
```python
sell_history = [
    {
        'ticker': 'KRW-BTC',
        'profit_loss': 1250.0,
        'profit_ratio': 2.45,
        'strategy': 'aggressive_scalping',
        'hold_time': '3분 24초',
        'time': '14:35:22'
    },
    # ... 최대 10건
]
```

### FIFO 방식
- 10건 초과 시 가장 오래된 기록 자동 삭제
- 최신 5건만 화면에 표시
- 스크롤 방지를 위한 최적화

---

## 🚀 업데이트 방법

### Windows
```batch
cd Lj-main
cd update
UPDATE.bat
```

### Linux/Unix
```bash
cd Lj-main
cp update/fixed_screen_display.py src/utils/
```

---

## ✅ 업데이트 확인

### 1. 버전 확인
화면 상단에 `v6.16-SELLHISTORY` 표시

### 2. 매도 기록 확인
- 매도 후 기록이 계속 남아있는지 확인
- 최근 5건이 화면에 표시되는지 확인
- 10건 초과 시 오래된 기록이 사라지는지 확인

### 3. 기능 테스트
```
1. 매수 → 매도 실행
2. 매도 후 5초 후에도 기록 유지 확인
3. 여러 번 매도 후 최근 5건만 표시 확인
```

---

## 📝 주요 변경 사항

### `fixed_screen_display.py`
1. **새 속성 추가**
   - `sell_history`: 매도 기록 리스트
   - `max_sell_history`: 최대 저장 개수 (10)

2. **`remove_position()` 수정**
   - 매도 시 `sell_history`에 기록 추가
   - FIFO 방식으로 오래된 기록 자동 삭제
   - 매도 횟수 카운트 증가

3. **`_render_sell_history()` 추가**
   - 최근 5건 표시
   - 최신순 정렬 (reversed)
   - 수익/손실 컬러 코드

4. **`render()` 수정**
   - 매도 기록 섹션 추가
   - 고정 높이 유지 (스크롤 방지)

---

## 🎨 화면 구성

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
[ 💼 보유 포지션 (2/7) ]
  ... 매수 포지션 ...
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
[ 📊 모니터링 ]
  ... 작업 상태 ...
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
[ 📜 매도 기록 (5건) ]  ← ⭐ 새로 추가!
  ✅ 14:35:22 | KRW-BTC | +1,250원 (+2.45%) | aggressi
  ❌ 14:30:15 | KRW-ETH | -350원 (-0.87%) | conserva
  ✅ 14:25:08 | KRW-XRP | +800원 (+1.52%) | scalping
  ✅ 14:20:45 | KRW-ADA | +450원 (+1.12%) | scalping
  ❌ 14:15:33 | KRW-DOGE | -120원 (-0.35%) | aggressi
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

---

## 💡 사용 팁

### 1. 매도 기록 분석
- 수익/손실 패턴 확인
- 전략별 성과 비교
- 시간대별 거래 패턴 분석

### 2. 스크롤 방지
- 최대 5건만 표시하여 화면 고정 유지
- 10건 초과 시 자동 정리

### 3. 실시간 모니터링
- 매수 포지션 + 매도 기록 동시 확인
- 전체 거래 흐름 파악

---

## 🔗 관련 문서
- [UPDATE_GUIDE.md](UPDATE_GUIDE.md) - 전체 업데이트 가이드
- [QUICK_UPDATE.md](QUICK_UPDATE.md) - 빠른 업데이트 가이드

---

## 📞 문의
GitHub: https://github.com/lee-jungkil/Lj

---

**업데이트 완료!** 이제 매도 기록이 사라지지 않고 계속 표시됩니다! 🎉
